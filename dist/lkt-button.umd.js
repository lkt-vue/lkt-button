(function(t,l){typeof exports=="object"&&typeof module<"u"?module.exports=l(require("vue"),require("lkt-events"),require("lkt-string-tools"),require("lkt-http-client"),require("lkt-modal-confirm")):typeof define=="function"&&define.amd?define(["vue","lkt-events","lkt-string-tools","lkt-http-client","lkt-modal-confirm"],l):(t=typeof globalThis<"u"?globalThis:t||self,t.LktButton=l(t.Vue,t.LktEvents,t.LktStringTools,t.LktHttpClient,t.LktModalConfirm))})(this,function(t,l,s,C,m){"use strict";var N=Object.defineProperty;var q=(t,l,s)=>l in t?N(t,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[l]=s;var y=(t,l,s)=>(q(t,typeof l!="symbol"?l+"":l,s),s);const _=(n=>n&&typeof n=="object"&&"default"in n?n:{default:n})(m),w="";var k=(n=>(n.button="button",n.submit="submit",n.reset="reset",n))(k||{});class d{}y(d,"DEFAULT_STATE","");const L=["name","type","disabled"],b={key:0,class:"lkt-button-prev"},B={key:1,class:"lkt-button-content"},S={key:3,class:"lkt-button-next"},E={name:"LktButton",inheritAttrs:!1},g=t.defineComponent({...E,props:{type:{default:k.button},name:{default:s.generateRandomString(10)},palette:{default:d.DEFAULT_STATE},value:{default:""},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},wrapContent:{type:Boolean,default:!1},resource:{default:""},resourceData:{default:()=>({})},confirmModal:{default:""},confirmModalKey:{default:"_"},confirmData:{default:()=>({})}},emits:["click","loading","loaded"],setup(n,{expose:c,emit:D}){const o=n,r=D,p=t.useSlots(),i=t.ref(o.loading),T=t.computed(()=>{let e=[];return o.palette&&e.push(`lkt-button--${o.palette}`),i.value&&e.push("is-loading"),e.join(" ")}),A=t.computed(()=>!!p.next),M=t.computed(()=>!!p.prev),f=async e=>(i.value=!0,r("loading"),C.httpCall(o.resource,o.resourceData).then(a=>{i.value=!1,r("loaded"),r("click",e,a)}).catch(a=>{i.value=!1,r("loaded"),r("click",e,a)})),h=e=>{if(o.confirmModal){let a=typeof o.confirmData=="object"?JSON.parse(JSON.stringify(o.confirmData)):{};if(typeof a.onConfirm=="function"){let u=a.onConfirm.bind({});a.onConfirm=()=>{if(o.resource)return f(e).then(()=>{u()});r("click",e,l.createLktEvent(o.name,o.value))}}else a.onConfirm=()=>{if(o.resource)return f(e);r("click",e,l.createLktEvent(o.name,o.value))};return m.openConfirm(o.confirmModal,o.confirmModalKey,a)}if(o.resource)return f(e);r("click",e,l.createLktEvent(o.name,o.value))};return t.watch(()=>o.loading,()=>i.value=o.loading),c({click:()=>h(null)}),(e,a)=>{const u=t.resolveComponent("lkt-spinner");return t.openBlock(),t.createElementBlock("button",{class:t.normalizeClass(["lkt-button",T.value]),name:e.name,type:e.type,disabled:e.disabled,onClick:t.withModifiers(h,["prevent","stop"])},[M.value?(t.openBlock(),t.createElementBlock("span",b,[t.renderSlot(e.$slots,"prev")])):t.createCommentVNode("",!0),e.wrapContent?(t.openBlock(),t.createElementBlock("span",B,[t.renderSlot(e.$slots,"default")])):t.renderSlot(e.$slots,"default",{key:2}),A.value?(t.openBlock(),t.createElementBlock("span",S,[t.renderSlot(e.$slots,"next")])):t.createCommentVNode("",!0),i.value?(t.openBlock(),t.createBlock(u,{key:4})):t.createCommentVNode("",!0)],10,L)}}});return{install:(n,c)=>{n.component("lkt-button")===void 0&&n.component("lkt-button",g),c&&c.defaultState&&(d.DEFAULT_STATE=c.defaultState),n.component("lkt-modal-confirm")===void 0&&n.use(_.default)}}});
