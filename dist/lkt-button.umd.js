(function(t,l){typeof exports=="object"&&typeof module<"u"?module.exports=l(require("vue"),require("lkt-events"),require("lkt-control-tools"),require("lkt-http-client"),require("lkt-modal-confirm")):typeof define=="function"&&define.amd?define(["vue","lkt-events","lkt-control-tools","lkt-http-client","lkt-modal-confirm"],l):(t=typeof globalThis<"u"?globalThis:t||self,t.LktButton=l(t.Vue,t.LktEvents,t.LktControlTools,t.LktHttpClient,t.LktModalConfirm))})(this,function(t,l,i,C,S){"use strict";var N=Object.defineProperty;var j=(t,l,i)=>l in t?N(t,l,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[l]=i;var h=(t,l,i)=>(j(t,typeof l!="symbol"?l+"":l,i),i);var d=(n=>(n.button="button",n.submit="submit",n.reset="reset",n))(d||{});const b=n=>{switch(n){case d.button:case d.reset:case d.submit:return!0;default:i.assertNever(n)}return!1};class f{}h(f,"DEFAULT_STATE","");function B(n=10){let s="";const u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=u.length;for(let r=0;r<n;r++)s+=u.charAt(Math.floor(Math.random()*e));return s}const L=["name","type","disabled"],g={key:0,class:"lkt-button-prev"},E={key:1,class:"lkt-button-content"},T={key:3,class:"lkt-button-next"},_={name:"LktButton",inheritAttrs:!1},A=t.defineComponent({..._,props:{type:{type:String,default:d.button,validator:b},name:{type:String,default:()=>B(10)},palette:{type:String,default:()=>f.DEFAULT_STATE},value:{type:String,default:""},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},wrapContent:{type:Boolean,default:!1},resource:{type:String,default:""},resourceData:{type:Object,required:!1,default:()=>({})},confirmModal:{type:String,default:""},confirmModalKey:{type:String,default:"_"},confirmData:{type:Object,required:!1,default:()=>({})}},emits:["click","loading","loaded"],setup(n,{expose:s,emit:u}){const e=n,r=u,k=t.useSlots(),c=t.ref(e.loading),M=t.computed(()=>{let o=[];return e.palette&&o.push(`lkt-button--${e.palette}`),c.value&&o.push("is-loading"),o.join(" ")}),D=t.computed(()=>!!k.next),q=t.computed(()=>!!k.prev),m=async o=>(c.value=!0,r("loading"),C.httpCall(e.resource,e.resourceData).then(a=>{c.value=!1,r("loaded"),r("click",o,a)}).catch(a=>{c.value=!1,r("loaded"),r("click",o,a)})),y=o=>{if(e.confirmModal){let a=typeof e.confirmData=="object"?JSON.parse(JSON.stringify(e.confirmData)):{};if(typeof a.onConfirm=="function"){let p=a.onConfirm.bind({});a.onConfirm=()=>{if(e.resource)return m(o).then(()=>{p()});r("click",o,l.createLktEvent(e.name,e.value))}}else a.onConfirm=()=>{if(e.resource)return m(o);r("click",o,l.createLktEvent(e.name,e.value))};return S.openConfirm(e.confirmModal,e.confirmModalKey,a)}if(e.resource)return m(o);r("click",o,l.createLktEvent(e.name,e.value))};return t.watch(()=>e.loading,()=>c.value=e.loading),s({click:()=>y(null)}),(o,a)=>{const p=t.resolveComponent("lkt-spinner");return t.openBlock(),t.createElementBlock("button",{class:t.normalizeClass(["lkt-button",M.value]),name:n.name,type:n.type,disabled:n.disabled,onClick:t.withModifiers(y,["prevent","stop"])},[q.value?(t.openBlock(),t.createElementBlock("span",g,[t.renderSlot(o.$slots,"prev")])):t.createCommentVNode("",!0),n.wrapContent?(t.openBlock(),t.createElementBlock("span",E,[t.renderSlot(o.$slots,"default")])):t.renderSlot(o.$slots,"default",{key:2}),D.value?(t.openBlock(),t.createElementBlock("span",T,[t.renderSlot(o.$slots,"next")])):t.createCommentVNode("",!0),c.value?(t.openBlock(),t.createBlock(p,{key:4})):t.createCommentVNode("",!0)],10,L)}}});return{install:(n,s)=>{n.component("lkt-button",A),s&&s.defaultState&&(f.DEFAULT_STATE=s.defaultState)}}});
